<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="io.renren.modules.sys.dao.DispatchInfoDao">

    <!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="io.renren.modules.sys.entity.DispatchInfoEntity" id="dispatchInfoMap">
            <result property="id" column="id"/>
            <result property="month" column="month"/>
            <result property="courierId" column="courier_id"/>
            <result property="allOrderTotal" column="all_order_total"/>
            <result property="countOrderTotal" column="count_order_total"/>
            <result property="large" column="large"/>
            <result property="small" column="small"/>
            <result property="thrIdentical" column="thr_identical"/>
            <result property="afterSale" column="after_sale"/>
            <result property="sellerPick" column="seller_pick"/>
            <result property="salary" column="salary"/>
            <result property="creater" column="creater"/>
            <result property="createDate" column="create_date"/>
            <result property="modify" column="modify"/>
            <result property="modifyDate" column="modify_date"/>
            <result property="isDelete" column="is_delete"/>
            <result property="deductMoney" column="deduct_money"/>
            <result property="cityName" column="cityName"/>
            <result property="area" column="area"/>
            <result property="site" column="site"/>
            <result property="courierName" column="courier_name"/>
            <result property="erpId" column="erp_id"/>
    </resultMap>

    <select id="getDispatchList" parameterType="io.renren.modules.sys.entity.DispatchInfoEntity" resultMap="dispatchInfoMap">
        SELECT a.*,b.courier_name,b.area,b.site,b.erp_id,c.`name` as cityName
        FROM tb_dispatch_info a
        LEFT JOIN tb_courier b
        ON a.courier_id = b.id
        LEFT JOIN tb_city_info c
        ON b.city_id = c.id
        where 1=1
        <if test="courierName != null and courierName != ''">
            and b.courier_name like CONCAT('%',ltrim(rtrim(#{courierName})),'%')
        </if>
        <if test="month != null and month != ''">
            and a.month = #{month}
        </if>
    </select>


    <resultMap type="io.renren.modules.sys.entity.CourierEntity" id="courierMap">
        <result property="id" column="id"/>
        <result property="courierName" column="courier_name"/>
        <result property="cardId" column="card_id"/>
        <result property="phone" column="phone"/>
        <result property="bankCardId" column="bank_card_id"/>
        <result property="depositBank" column="deposit_bank"/>
        <result property="joinBankNumber" column="join_bank_number"/>
        <result property="entryDate" column="entry_date"/>
        <result property="leaveDate" column="leave_date"/>
        <result property="status" column="status"/>
        <result property="comment" column="comment"/>
        <result property="erpId" column="erp_id"/>
        <result property="area" column="area"/>
        <result property="site" column="site"/>
        <result property="pactId" column="pact_id"/>
        <result property="cityId" column="city_id"/>
        <result property="creater" column="creater"/>
        <result property="createDate" column="create_date"/>
        <result property="modify" column="modify"/>
        <result property="modifyDate" column="modify_date"/>
        <result property="isDelete" column="is_delete"/>
    </resultMap>

    <!--查询配送员信息-->
    <select id="getCourierInfo" resultMap="courierMap">
        select  from  tb_courier where courier_name = #{courierName} and erp_id = #{erpId}
    </select>

    <!--插入数据信息-->
    <insert id="insertDispatch" parameterType="io.renren.modules.sys.entity.DispatchInfoEntity">
        insert into tb_dispatch_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="month != null and month != ''">
                month,
            </if>
            <if test="courierId != null and courierId != ''">
                courier_id,
            </if>
            <if test="allOrderTotal != null and allOrderTotal != ''">
                all_order_total,
            </if>
            <if test="countOrderTotal != null and countOrderTotal != ''">
                count_order_total,
            </if>
            <if test="large != null and large != ''">
                large,
            </if>
            <if test="small != null and small != ''">
                small,
            </if>
            <if test="thrIdentical != null and thrIdentical != ''">
                thr_identical,
            </if>
            <if test="afterSale != null and afterSale != ''">
                after_sale,
            </if>
            <if test="sellerPick != null and sellerPick != ''">
                seller_pick,
            </if>
            <if test="salary != null and salary != ''">
                salary,
            </if>
            <if test="deductMoney != null and deductMoney != ''">
                deduct_money,
            </if>
            <if test="remark != null and remark != ''">
                remark,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="month != null and month != ''">
                #{month},
            </if>
            <if test="courierId != null and courierId != ''">
                #{courierId},
            </if>
            <if test="allOrderTotal != null and allOrderTotal != ''">
                #{allOrderTotal},
            </if>
            <if test="countOrderTotal != null and countOrderTotal != ''">
                #{countOrderTotal},
            </if>
            <if test="large != null and large != ''">
                #{large},
            </if>
            <if test="small != null and small != ''">
                #{small},
            </if>
            <if test="thrIdentical != null and thrIdentical != ''">
                #{thrIdentical},
            </if>
            <if test="afterSale != null and afterSale != ''">
                #{afterSale},
            </if>
            <if test="sellerPick != null and sellerPick != ''">
                #{sellerPick},
            </if>
            <if test="salary != null and salary != ''">
                #{salary},
            </if>
            <if test="deductMoney != null and deductMoney != ''">
                #{deductMoney},
            </if>
            <if test="remark != null and remark != ''">
                #{remark},
            </if>
        </trim>
    </insert>
</mapper>